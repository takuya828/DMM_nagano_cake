<%= flash[:danger] %>
<%= flash[:success] %>

<h1>ショッピングカート</h1>
<%= button_to "カートを空にする", destroy_all_cart_items_path, method: :delete %>

<% @cart_items.each do |cart_item| %>
<%= attachment_image_tag(cart_item.item, :image, :fill, 50, 50, format: 'jpeg', fallback: "no_image.jpg") %>
<p>商品名　<%= cart_item.item.name %></p>
<p>単価　<%= cart_item.item.add_tax_price.to_s(:delimited) %>　</p>
<%= form_with model: cart_item, url: cart_item_path(cart_item), local:true do |f| %>
<p>数量　<%= f.select :amount, *[1..20], {selected: cart_item.amount} %></p>
<%= f.submit "変更" %>
<% end %>
<p>小計 <%= (cart_item.item.price * 1.1).floor * cart_item.amount %></p>

<%= link_to "削除する", cart_item_path(@cart_item, id: cart_item), method: :delete, data: {confirm: "削除しますか？"}  %><br>

<% end %>
<h2>合計 <%= @total.round.to_s(:delimited) %></h2>


 <%= link_to "買い物を続ける", root_path %><br>

 <%= link_to "情報入力に進む", new_order_path %>